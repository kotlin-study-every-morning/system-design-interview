## 단일 서버
### 개요
- 비즈니스 첫 단계에서 사용 할 수 있는 가장 간단한 방식의 시스템 설계 방법

### 구조
- 웹, 앱, 데이터베이스, 캐시 등이 전부 서버 한대에서 실행



## 데이터베이스
### 개요
- 사용자가 늘면 데이터도 늘어난다. 이를 대비하기 위한 데이터 베이스 선택 방법

### 어떤 데이터 베이스를 사용할 것인가?
- 관계형 데이터 베이스
  1. 40년 이상 시장에서 살아남아 사용 된 시스템
  2. 대부분의 경우에 관계형 데이터 베이스를 통해 구현 가능
- 비-관계형 데이터 베이스
  1. 아주 낮은 응답 지연 시간 요구
  2. 비정형 데이터
  3. 직렬화 or 역직렬화만 필요
  4. 대용량 데이터

## 수직적 규모 확장 vs 수평적 규모 확장
### 개요
- 부하 감소를 위한 각각의 서버에 대한 대응을 어떻게 할 것인가?
### 스케일 업, 스케일 아웃
- 스케일 업 : 서버에 고사양 자원(CPU, RAM 등)을 추가하는 행위
  - 트래픽의 양이 적을 때는 단순함으로 인해 수직적 확장이 좋은 선택
  - 스케일 업의 한계가 존재
  - 장애 자동 복구, 다중화 방안이 없음
- 스케일 아웃: 서버를 추가하여 성능을 개선하는 행위
  - 결론적으로는 수평적 규모 확장이 필요

#### 수평적 규묘 확장은 어떻게 하는지?
### 로드 밸런서
- 웹 서버 스케일 아웃에서 각 웹 서버에 트래픽을 고르게 분산하는 도구
- 다양한 로드 밸런싱 방법

### 데이터베이스 다중화
- 마스터, 슬레이브 구조
  1. 마스터가 주 데이터, 슬레이브는 사본
  2. 마스터에서 쓰기, 슬레이브는 읽기 연산을 지원
  3. 슬레이브의 수는 계속 추가 가능함
## 캐시
### 개요
- 데이터 응답 시간을 줄일 수 있는 방법은 무엇일까?
### 캐시 계층
- 디스크를 활용하는 데이터 베이스 데이터를 주 메모리를 활용해 불러 오는 방법
- 데이터 베이스와 웹 서버(요청) 사이에 존재
- 동일한 요청이 여러번 반복 될 경우 데이터베이스를 활용하지 않고 캐시된 데이터를 불러옴
### 캐시 사용시 유의할 점
- 캐시 사용 여부 확인
- 캐시 사용 범위
- 캐시 데이터 만료 정책
- 일관성 유지
- 장애 대처
- 캐시 메모리의 크기
- 데이터 방출 정책
## 콘텐츠 전송 네트워크(CDN)
### 개요
- 정적 콘텐츠의 처리는 어떻게 할까?
### 사용 범위
- 항상 같은 데이터 (이미지, 비디오, CSS, JS 파일 등)
  - 동적 콘텐츠 캐싱 예외
### 책에서 나온 CDN
- 지리적으로 분산된 여러 지역의 서버에서 가장 빠르게 정적 데이터를 가져 올 수 있도록 도와주는 네트워크
### CDN 사용 시 고려해야 할 사항
- 비용
- 적절한 만료 시한 설정
- CDN 장애 대처 방안
- 콘텐츠 무효화 방법

## 무상태(stateless) 웹 계층
### 개요
- 수평적 규모 확장이 이루어진 웹 서버에서 같은 상태 정보를 공유 할 수 있는 방법
### 무상태 아키텍처
- 공유 저장소로 부터 상태 정보를 가져와 처리
- 공유 저장소는 RDB, NOSQL, 캐시 시스템 등 다양한 방법이 존재
### ?
- JWT는 어떨까
## 데이터 센터
### 개요
- 글로벌 서비스로 발전할 경우 지리적 차이에서 오는 데이터 지연을 처리하는 방법
### 처리 방법
- 다양한 지역에 물리적으로 가까운 데이터 센터 구축
- 지리적 라우팅을 통해 사용자의 위치에 따라 각기 다른 데이터 센터로 요청을 처리
### 기술적 난제
- 트래픽 우회
- 데이터 동기화
- 테스트와 배포
## 메시지 큐
### 개요
- 시스템을 더욱 크게 확장하기 위해 컴포넌트로 분리하며 각기 독립적으로 활용할 때 데이터를 처리하는 방법
### 구조
- 생산자, 발행자 방식
### 사용 이유
- 서비스 혹은 서버간 결합이 느슨해져 규모 확장성이 보장
- 소비자 혹은 생산자 장애시에도 메시지 처리 가능
## 로그, 메트릭 그리고 자동화
### 개요
- 시스템이 커진다면 사업도 커지기 마련, 시스템과 비즈니스에 관련된 데이터를 사용하기 위한 방법
### 데이터 사용 범위
- 로그
  - 시스템의 오류와 문제를 찾기 쉽도록 데이터 기록
  - 시스템의 규모가 크다면 단일 서비스 도구 활용
- 메트릭
  - 사업 현황에 관한 데이터 수집
  - 호스트, 종합, 핵심 비즈니스 메트릭 수집
- 자동화
  - 생산성을 높이기 위한 도구
  - CI 도구를 사용한 다양한 검증 절차 자동화
  - 빌드, 테스트, 배포 자동화
## 데이터베이스의 규모 확장
### 개요
- 데이터 부하 감소를 위한 각각의 서버에 대한 대응을 어떻게 할 것인가?
### 데이터 샤딩
- 각 데이터의 중복 없이 여러 데이터베이스에 분산해 저장하는 방법
#### 데이터 샤딩의 문제
- 데이터 재 샤딩
- 유명인사 문제
- 조인과 비정규화

## 정리
- 웹 계층은 무상태 계층으로
- 모든 계층에 다중화 도입
- 가능한 한 많은 데이터를 캐시할 것
- 여러 데이터 센터를 지원할 것
- 정적 콘텐츠는 CDN을 통해 서비스할 것
- 데이터 계층은 샤딩을 통해 그 규모를 확장할 것
- 각 계층은 독립적 서비스로 분할할 것
- 시스템을 지속적으로 모니터링하고, 자동화 도구들을 활용할 것
